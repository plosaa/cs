主定理的证明具体见 《算法导论》 4.6

出发点为：

![img](img/1.png)

这里 $a^{log_b{n}} = n^{log_b{a}}$ 是用了对数的互换[性质](https://zh.wikipedia.org/wiki/%E5%AF%B9%E6%95%B0):

$M^{log_\alpha{N}} = N^{log_\alpha{M}}$

证明完整过程见算法导论，

![img](img/2.png)

这里只记用到的一个点，如何证明

$log^k{n} + log^k{(n / b)} + log^k{(n / b^2)} + ... + log^k{(n / b^{log_bn})} = \theta(logn * log^kn)$

证明来自字母哥[jdhrjksjxjiieisiwoisiwhs](https://www.xiaohongshu.com/user/profile/64b4c8ab000000001c028a15)认识的研友[往复随安](https://www.xiaohongshu.com/user/profile/671ccf6a000000001d030074)

原式 

$I = \sum \limits_{i=0}^{log_bn} log^k{(n / b^i)}$

$= \sum \limits_{i=0}^{log_bn} (logn - ilogb)^k$

$logn = logblog_b{n}$ (关键步骤，用对数的链式性质 $log_\gamma\beta log_\beta\alpha = log_\gamma\alpha$ 弄出来一个logb，这样就能把logb提出来)

$I = \sum \limits_{i=0}^{log_bn} (logblog_b{n} - ilogb)^k$

$= log^k{b}\sum \limits_{i=0}^{log_bn} (log_b{n} - i)^k$

记 $m = log_b{n}$

$= log^k{b}\sum \limits_{i=0}^m (m - i)^k$

$= log^k{b}\sum \limits_{i=0}^m i^k$

$\approx log^k{b}\int_0^m{x^k}dx$

$= log^k{b} * m^{k+1} / (k + 1)$ （**这步需要 $k \ne -1$**）

$= \theta(log_b^{k+1}n) = \theta(log^{k+1}n)$