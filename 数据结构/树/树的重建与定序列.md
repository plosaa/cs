* 05.Binary Trees.pdf P76

## 树的重建

给定树的遍历序列，把树给重建出来。

以下假设为二叉树，且树节点值各不相同。

[先序 | 后序 | 层序] + 中序，可以重建树✅，通过前者先**确定根**，然后通过后者划分左右子树，从而递归子问题。

相关题目:

* [LeetCode105. 从前序与中序遍历序列构造二叉树](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal/)

* [LeetCode106. 从中序与后序遍历序列构造二叉树](https://leetcode.cn/problems/construct-binary-tree-from-inorder-and-postorder-traversal/)

$C_4^2$ 种组合，能重建树的只有：

* 先序 + 中序 ✅

* 后序 + 中序 ✅

* 层序 + 中序 ✅

$3$ 种（中序 + 任意另外一个），都是先确定根，然后划分左右子树，然后递归子问题。

## 树的定序列

有些组合，虽然不能重建树，但是对于可能的多种形态，其某种遍历结果却可能确定。

以下假设为二叉树，且树节点值各不相同。

相关题目:

* [LeetCode889. 根据前序和后序遍历构造二叉树](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-postorder-traversal/)

以这个先序 + 后序的组合为例，如果树是**真二叉树**，则确实可以重建树。但是一旦一个节点只有一棵子树，则
```
  1    1
 /  和  \
2        2
```
的先序、后序相同，树的结构就不确定了。对于子树的构建：

1. 若 preorder[1] != postorder[n - 2] ，则根节点二叉，且 preorder[1] 为左子树根，postorder[n - 2] 为右子树根。没有不确定性。

2. 若 preorder[1] == postorder[n - 2] ，则根节点单叉，但无法确定 preorder[1] 为左子树根还是右子树根。树的结构不确定。根本原因在于 根左空 + 左空根 和 根空右 + 空右根 ，在结果上看是一样的。

但是，虽然树的结构不确定，但是层序都是一样的。先序 + 后序能确定层序。

先 中 后 层 的组合方案结论：

* 先序 + 中序 推出一切 ✅

* 后序 + 中序 推出一切 ✅

* 层序 + 中序 推出一切 ✅

* 先序 + 后序 $\Rightarrow$ 层序 ✅

    具体证明见上方

* 先序 + 后序 $\Rightarrow$ 中序 ❌

    ```
      1    1
     /      \
    2        2
    ```
* 先序 + 层序 $\Rightarrow$ 中序 ❌

    反例同上

* 先序 + 层序 $\Rightarrow$ 后序 ❌

    ```
      1     1        1
     /       \      /  \
    2   or    2    2    3
    |         |
    3         3    
    ```

* 后序 + 层序 $\Rightarrow$ 先序 ✅

    若 postorder[n - 2] != levelorder[1] ，则根双分支，可以明确地划分为左右子树问题；
    
    若 postorder[n - 2] == levelorder[1] ，则根单分支，子树可以左右摆动，但是虽然单分支左右摆动不改变后序和层序，先序也同样不会变（中序会变）；

    综上，后序 + 层序可以确定先序。

    此问题是上一问题换了一下，但是结论不一样。上一问题能构造出反例是因为其无法确定根节点是单分支还是双分支。如果把层序的定义改一下，改成同层从右向左遍历，其它遍历定义不变，则这两个问题的结论会反一次。

* 后序 + 层序 $\Rightarrow$ 中序 ❌

    ```
      1    1
     /      \
    2        2
    ```